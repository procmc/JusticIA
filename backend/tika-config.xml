<?xml version="1.0" encoding="UTF-8"?>
<properties>
  <!-- 
    Configuración de Tika Server con OCR integrado 
    - PDFParser: Extrae texto de PDFs normales
    - TesseractOCRParser: Aplica OCR a imágenes y PDFs escaneados
    - taskTimeoutMillis: 900000ms = 15 minutos para archivos pesados con OCR
  -->
  
  <!-- Configuración del servidor con timeouts extendidos -->
  <server>
    <params>
      <!-- Puerto del servidor -->
      <port>9998</port>
      <!-- Timeout de 15 minutos (900000ms) para archivos pesados con OCR -->
      <taskTimeoutMillis>900000</taskTimeoutMillis>
      <!-- Timeout mínimo permitido para requests individuales -->
      <minimumTimeoutMillis>30000</minimumTimeoutMillis>
      <!-- Verificar estado cada 5 segundos -->
      <taskPulseMillis>5000</taskPulseMillis>
      <!-- Máximo de archivos en cola -->
      <maxFiles>100</maxFiles>
    </params>
  </server>
  
  <parsers>
    <!-- Parser para documentos de Microsoft Office (.docx, .xlsx, .pptx, etc.) -->
    <parser class="org.apache.tika.parser.microsoft.ooxml.OOXMLParser">
      <params>
        <!-- Extraer contenido de texto -->
        <param name="extractMacros" type="bool">false</param>
        <param name="includeHeadersAndFooters" type="bool">true</param>
        <param name="useSAXDocxExtractor" type="bool">true</param>
      </params>
    </parser>
    
    <!-- Parser para documentos Office antiguos (.doc, .xls, .ppt) -->
    <parser class="org.apache.tika.parser.microsoft.OfficeParser">
      <params>
        <param name="extractMacros" type="bool">false</param>
      </params>
    </parser>
    
    <!-- Parser para Rich Text Format (.rtf) -->
    <parser class="org.apache.tika.parser.rtf.RTFParser">
      <params>
        <!-- Extraer texto formateado -->
      </params>
    </parser>
    
    <!-- Parser para OpenDocument Format (.odt, .ods, .odp) -->
    <parser class="org.apache.tika.parser.odf.OpenDocumentParser">
      <params>
        <!-- Soporta LibreOffice/OpenOffice -->
      </params>
    </parser>
    
    <!-- Parser por defecto para PDFs (extrae texto embebido) -->
    <parser class="org.apache.tika.parser.pdf.PDFParser">
      <params>
        <!-- Habilitar extracción de texto embebido -->
        <param name="extractInlineImages" type="bool">true</param>
        <param name="sortByPosition" type="bool">true</param>
        <!-- Configurar estrategia de OCR: auto (solo si no hay texto) -->
        <param name="ocrStrategy" type="string">auto</param>
      </params>
    </parser>
    
    <!-- Parser de OCR con Tesseract para imágenes y PDFs escaneados -->
    <parser class="org.apache.tika.parser.ocr.TesseractOCRParser">
      <params>
        <!-- Idioma por defecto: español -->
        <param name="language" type="string">spa+eng</param>
        <!-- Habilitar OCR -->
        <param name="enableOCR" type="bool">true</param>
        <!-- Calidad de imagen para OCR -->
        <param name="density" type="int">300</param>
        <param name="depth" type="int">4</param>
        <param name="colorspace" type="string">gray</param>
      </params>
    </parser>
  </parsers>
</properties>